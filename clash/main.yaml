# ä¿®æ”¹è‡ªå®˜æ–¹ç¤ºä¾‹è§„åˆ™ https://wiki.metacubex.one/example/#meta
# è™šç©ºç»ˆç«¯ (Clash Meta) Docs åœ°å€: https://wiki.metacubex.one

# true æ˜¯å¯ç”¨
# false æ˜¯ç¦ç”¨

# åˆ†ç»„
pr:
  &pr {
    type: select,
    proxies:
      [
        é»˜è®¤ä»£ç†,
        é¦™æ¸¯,
        å°æ¹¾,
        æ—¥æœ¬,
        æ–°åŠ å¡,
        ç¾å›½,
        å…¶å®ƒåœ°åŒº,
        å…¨éƒ¨èŠ‚ç‚¹,
        DIRECT,
      ],
  }
# å»¶è¿Ÿæ£€æµ‹ URL
p: &p
  type: http
  # è‡ªåŠ¨æ›´æ–°è®¢é˜…æ—¶é—´ï¼Œå•ä½ä¸ºç§’
  interval: 3600
  health-check:
    enable: true
    url: https://cp.cloudflare.com
    # èŠ‚ç‚¹è¿é€šæ€§æ£€æµ‹æ—¶é—´ï¼Œå•ä½ä¸ºç§’
    interval: 300
    # èŠ‚ç‚¹è¶…æ—¶å»¶è¿Ÿï¼Œå•ä½ä¸ºæ¯«ç§’
    timeout: 1000
    # èŠ‚ç‚¹è‡ªåŠ¨åˆ‡æ¢å·®å€¼ï¼Œå•ä½ä¸ºæ¯«ç§’
    tolerance: 100
# --------------------------------------------------

mode: rule
# ipv6 æ”¯æŒ
ipv6: true
log-level: info
# å…è®¸å±€åŸŸç½‘è¿æ¥
allow-lan: true
# socks5/http ç«¯å£
mixed-port: 7890
# Meta å†…æ ¸ç‰¹æ€§ https://wiki.metacubex.one/config/general
# ç»Ÿä¸€å»¶è¿Ÿ
# æ›´æ¢å»¶è¿Ÿè®¡ç®—æ–¹å¼,å»é™¤æ¡æ‰‹ç­‰é¢å¤–å»¶è¿Ÿ
unified-delay: true
# TCP å¹¶å‘
# åŒæ—¶å¯¹æ‰€æœ‰ipè¿›è¡Œè¿æ¥ï¼Œè¿”å›å»¶è¿Ÿæœ€ä½çš„åœ°å€
tcp-concurrent: true
# å¤–éƒ¨æ§åˆ¶ç«¯å£
external-controller: :9090

geodata-mode: true

# Geo æ•°æ®åº“ä¸‹è½½åœ°å€
# ä½¿ç”¨ FastGit ä»£ç† (https://fgit.cf)
# æºåœ°å€ https://github.com/MetaCubeX/meta-rules-dat
# å¯ä»¥æ›´æ¢é•œåƒç«™ä½†ä¸è¦æ›´æ¢å…¶ä»–æ•°æ®åº“ï¼Œå¯èƒ½å¯¼è‡´æ— æ³•å¯åŠ¨
geox-url:
  geoip: "https://ghp.ci/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat"
  geosite: "https://ghp.ci/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "https://ghp.ci/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb"
#  geoip: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat"
#  geosite: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
#  mmdb: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb"
  
# è¿›ç¨‹åŒ¹é…æ¨¡å¼
# è·¯ç”±å™¨ä¸Šè¯·è®¾ç½®ä¸º off
# always å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
# strict é»˜è®¤ï¼Œç”± Clash åˆ¤æ–­æ˜¯å¦å¼€å¯
# off ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
find-process-mode: strict

# ç¼“è§£ç§»åŠ¨è®¾å¤‡è€—ç”µé—®é¢˜
# https://github.com/vernesong/OpenClash/issues/2614
keep-alive-interval: 1800

# å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹
global-client-fingerprint: random # éšæœºæŒ‡çº¹

# ç¼“å­˜
profile:
  store-selected: true
  store-fake-ip: true

# è‡ªåŠ¨åŒæ­¥æ—¶é—´ä»¥é˜²æ­¢æ—¶é—´ä¸å‡†å¯¼è‡´æ— æ³•æ­£å¸¸è”ç½‘
ntp:
  enable: true
  # æ˜¯å¦åŒæ­¥è‡³ç³»ç»Ÿæ—¶é—´ï¼Œéœ€è¦ root/ç®¡ç†å‘˜æƒé™
  write-to-system: false
  server: time.apple.com
  port: 123
  interval: 30

# åŸŸåå—…æ¢
sniffer:
  enable: true
  sniff:
    TLS:
      ports: [443, 8443]
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true

# tun æ¨¡å¼
tun:
  enable: false  # enable 'true'
  stack: system  # or 'gvisor'
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-detect-interface: true

hosts:
  '*.tech-assast.us.kg': 172.66.47.251
  '*.tech1-assast.us.kg': 172.66.47.251
  '*.tech2-assast.us.kg': 172.66.47.251
  'tech-assast.us.kg': 172.66.47.251
  'tech1-assast.us.kg': 172.66.47.251
  'tech2-assast.us.kg': 172.66.47.251
  'hostevaluate.com': 172.66.47.251
  'lenoas.de': 172.66.47.251
  '*.lenoas.de': 172.66.47.251
  '*.sehuatang.org': 172.66.47.251
  'u2.dmhy.org': 172.66.47.251
  'audiences.me': 172.66.47.251
  'hdfans.org': 172.66.47.251
  'rousi.zip': 172.66.47.251
  'www.haidan.video': 172.66.47.251
  'zhuque.in': 172.66.47.251
  'sunnypt.top': 172.66.47.251
  'leaves.red': 172.66.47.251
  'tracker.leaves.red': 172.66.47.251
  'tracker2.leaves.red': 172.66.47.251
  'tracker3.leaves.red': 172.66.47.251
  'pt.keepfrds.com': 172.66.47.251
  'tracker.keepfrds.com': 172.66.47.251
  'springsunday.net': 172.66.47.251
  'ubits.club': 172.66.47.251
  'lemonhd.club': 172.66.47.251
  'www.hdkyl.in': 172.66.47.251
  'tracker.hdkyl.in': 172.66.47.251
  'www.hdkylin.top': 172.66.47.251
  'agsvpt.trackers.work': 172.66.47.251
  'zmpt.cc': 172.66.47.251
  'tracker.carpt.net': 172.66.47.251
  'carpt.net': 172.66.47.251
  'ptvicomo.net': 172.66.47.251
  'tracker.ptvicomo.net': 172.66.47.251
  'pterclub.com': 172.66.47.251
  'tracker.pterclub.com': 172.66.47.251
  'blutopia.cc': 172.66.47.251
  'totheglory.im': 172.66.47.251
  'tracker.totheglory.im': 172.66.47.251
  'ourbits.club': 172.66.47.251
  'ptchdbits.co': 172.66.47.251
  'tracker.ptchdbits.co': 172.66.47.251
  'tracker.rainbowisland.co': 172.66.47.251
  'chdbits.xyz': 172.66.47.251
  'invites.fun': 172.66.47.251
  'hdtime.org': 172.66.47.251
  'qingwapt.com': 172.66.47.251
  '*.qingwapt.com': 172.66.47.251
  '*.gitbook.io': 172.66.47.251
  '*.nodehatch.com': 172.66.47.251
  '*.lap.ink': 172.66.47.251
  'tjupt.org': 172.66.47.251
  # '*.nodeseek.com': 172.66.47.251 è™½ç„¶æ˜¯cfçš„ ä½†æ˜¯å¥½åƒä¼˜é€‰ä¹Ÿè¿ä¸ä¸Š
  '*.gtkpw.xyz': 172.66.47.251
  '*.cloudflare.com': 172.66.47.251
  'linux.do': 172.66.47.251
  'hhanclub.top': 172.66.47.251

# dns è®¾ç½®
# å·²é…ç½® ipv6
dns:
  enable: true
  listen: :1053
  ipv6: true
  # è·¯ç”±å™¨ä¸ªäººå»ºè®®ä½¿ç”¨ redir-host ä»¥æœ€ä½³å…¼å®¹æ€§
  # å…¶ä»–è®¾å¤‡å¯ä»¥ä½¿ç”¨ fake-ip
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter:
    - '*'
    - '+.lan'
    - '+.local'
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - 114.114.114.114
    - '[2402:4e00::]'
    - '[2400:3200::1]'
  nameserver:
    - 'tls://8.8.4.4#dns'
    - 'tls://1.0.0.1#dns'
    - 'tls://[2001:4860:4860::8844]#dns'
    - 'tls://[2606:4700:4700::1001]#dns'
#  proxy-server-nameserver:
#    - https://doh.pub/dns-query
#  nameserver-policy:
#    "geosite:cn,private":
#      - https://doh.pub/dns-query
#      - https://dns.alidns.com/dns-query
#    "geosite:!cn,!private": 
#      - "tls://dns.google"
#      - "tls://cloudflare-dns.com"

# ä»£ç†é…ç½®
use: &use
  type: select
  use:
    - æ ·ä¾‹

# è®¢é˜…é“¾æ¥
# å¯¹äºè®¢é˜…æ¥è¯´ï¼Œpath ä¸ºé€‰å¡«é¡¹ï¼Œä½†å»ºè®®å¯ç”¨
# æœ¬åœ°é…ç½®å¯ä»¥åªå¡« path
proxy-providers:
  é™¢é•¿:
    <<: *p
    path: ./proxy_provider/æ ·ä¾‹.yaml
    url: "http://X/X"
    # å¦‚éœ€è¦ä¸ºè¯¥è®¢é˜…ç»„èŠ‚ç‚¹æ·»åŠ å‰ç¼€ï¼Œå–æ¶ˆä¸‹é¢ä¸¤è¡Œæ³¨é‡Š
    override:
      additional-prefix: "[æ ·ä¾‹]"
      
proxy-groups:
  # ä½¿ç”¨ WARP çš„ç”¨æˆ·éœ€è¦æ‰‹åŠ¨åœ¨ä¸‹æ–¹çš„ proxies å­—æ®µå†…æ·»åŠ  WARP
  # ä¾‹å¦‚ [WARP, å…¨éƒ¨èŠ‚ç‚¹, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, å…¶å®ƒåœ°åŒº, DIRECT],
  - {
      name: é»˜è®¤ä»£ç†,
      type: select,
      proxies:
        [å…¨éƒ¨èŠ‚ç‚¹, é¦™æ¸¯, å°æ¹¾, æ—¥æœ¬, æ–°åŠ å¡, ç¾å›½, å…¶å®ƒåœ°åŒº, DIRECT],
    }
  # è¿™é‡Œçš„ dns æŒ‡æµ·å¤–è§£æ dns èµ°çš„èŠ‚ç‚¹ï¼Œä¸€èˆ¬è·Ÿéšé»˜è®¤ä»£ç†å³å¯
  - { name: dns, <<: *pr }

  # åˆ†éš”,ä¸‹é¢æ˜¯åœ°åŒºåˆ†ç»„
  - { name: é¦™æ¸¯, <<: *use, filter: "(?i)æ¸¯|hk|hongkong|hong kong"}
  - { name: å°æ¹¾, <<: *use, filter: "(?i)å°|tw|taiwan"}
  - { name: æ—¥æœ¬, <<: *use, filter: "(?i)æ—¥æœ¬|jp|japan"}
  - { name: ç¾å›½, <<: *use, filter: "(?i)ç¾|us|unitedstates|united states"}
  - { name: æ–°åŠ å¡, <<: *use, filter: "(?i)(æ–°|sg|singapore)"}
  - {
      name: å…¶å®ƒåœ°åŒº,
      <<: *use,
      filter: "(?i)^(?!.*(?:ğŸ‡­ğŸ‡°|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¨ğŸ‡³|æ¸¯|hk|hongkong|å°|tw|taiwan|æ—¥|jp|japan|æ–°|sg|singapore|ç¾|us|unitedstates)).*"
    }
  - { name: å…¨éƒ¨èŠ‚ç‚¹, <<: *use }
  
# è§„åˆ™è®¢é˜…
rule-providers:
  # ç§‹é£å¹¿å‘Šæ‹¦æˆªè§„åˆ™
  # https://awavenue.top
  # # ç”±äº Anti-AD è¯¯æ€ç‡é«˜ï¼Œæœ¬é¡¹ç›®å·²åœ¨ 1.11-241024 ç‰ˆæœ¬æ›´æ¢ç§‹é£å¹¿å‘Šè§„åˆ™
  AWAvenue-Ads:
    type: http
    behavior: domain
    format: yaml
    # pathå¯ä¸ºç©º(ä»…é™clash.meta 1.15.0ä»¥ä¸Šç‰ˆæœ¬)
    path: ./rule_provider/AWAvenue-Ads.yaml
    url: "https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/refs/heads/main/Filters/AWAvenue-Ads-Rule-Clash.yaml"
    interval: 600

  myproxy:
    type: http
    path: ./rule_provider/proxy.yaml
    url: "https://raw.githubusercontent.com/assast/static/refs/heads/main/clash/proxy.yaml"
    interval: 600
    behavior: classical
    format: yaml
    size-limit: 0


rules:
  - RULE-SET,AWAvenue-Ads,REJECT
  - RULE-SET,myproxy,é»˜è®¤ä»£ç†
  # - DOMAIN-SUFFIX,infini.money,é»˜è®¤ä»£ç†
  # - DOMAIN-SUFFIX,gitbook.io,é»˜è®¤ä»£ç†

  - MATCH,DIRECT